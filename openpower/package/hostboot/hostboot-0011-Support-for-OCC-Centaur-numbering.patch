From 9d5d91597d325d63465a4f62a98bb5d8ff0f90a4 Mon Sep 17 00:00:00 2001
From: Doug Gilbert <dgilbert@us.ibm.com>
Date: Wed, 3 Jun 2015 14:06:09 -0500
Subject: [PATCH] Support for OCC Centaur numbering

Change-Id: I11f6641548dbb0a0f4f586f592fa0d357a6c9a84
RTC: 127111
Reviewed-on: http://gfw160.aus.stglabs.ibm.com:8080/gerrit/18179
Tested-by: Jenkins Server
Reviewed-by: Christopher Cain <cjcain@us.ibm.com>
Reviewed-by: Martha Broyles <mbroyles@us.ibm.com>
Reviewed-by: A. Patrick Williams III <iawillia@us.ibm.com>
---
 src/usr/htmgt/htmgt_cfgdata.C | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/src/usr/htmgt/htmgt_cfgdata.C b/src/usr/htmgt/htmgt_cfgdata.C
index dcf1f9d..f4bcfd8 100644
--- a/src/usr/htmgt/htmgt_cfgdata.C
+++ b/src/usr/htmgt/htmgt_cfgdata.C
@@ -307,6 +307,8 @@ void getMemConfigMessageData(const TargetHandle_t i_occ,
 
             //Centaur #
             centPos = (*centaur)->getAttr<ATTR_POSITION>();
+            // ATTR_POSITION is system wide. Must be 0-7 on each OCC
+            centPos = centPos % 8;
             o_data[index++] = centPos;
 
             //Dimm # (0xFF since a centaur)
@@ -425,6 +427,8 @@ void getMemThrottleMessageData(const TargetHandle_t i_occ,
     for (centaur=centaurs.begin(); centaur!=centaurs.end(); ++centaur)
     {
         centPos = (*centaur)->getAttr<ATTR_POSITION>();
+        // ATTR_POSITION is system wide. Must 0-7 on each OCC
+        centPos = centPos % 8;
 
         mbas.clear();
         getChildAffinityTargets(mbas, *centaur,
-- 
2.3.0

